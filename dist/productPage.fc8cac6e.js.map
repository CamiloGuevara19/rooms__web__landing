{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,gFCMA,MAAMC,EAAqBC,SAASC,eAAe,eAC7CC,EAAuBF,SAASC,eAAe,iBAGrD,IAAIE,EACAC,EAAO,GAUXC,eAAeC,IACX,MAAMC,EATV,SAAkBC,GACd,MAAMC,EAAMC,OAAOC,SAASC,OAI5B,OAHqB,IAAIC,gBAAgBJ,GACVK,IAAIN,GAMjBO,CAAS,OAa/B,SAAuBC,GAEnB,MACMC,EADkBb,EAAKc,MAAMC,GAAgBA,EAAYC,KAAOJ,EAAQI,KAC/B,kEAAoE,uDAEnHrB,EAAmBsB,UAAY,sCAYHL,EACxBM,kDAG0BN,EAASO,mDACjBC,EAAAC,eAA0BT,EAAAU,gCAI5CL,UAAA,mBAEIL,EAAAW,OAAA,wDAKJX,EAAAW,OAAAC,OAAsB,YAmBKD,GAE/B,MAAAE,EAAc7B,SAAAC,eAA2B,aACrC6B,EAAY9B,SAAQ+B,cAChB,SAELC,UAAA,mBACNL,EAAAM,SAAAC,IAEDJ,EAAAT,WAAA,uBACca,qBAGWC,YAACL,GAClB9B,SAAIoC,cAAS,qBACTC,iBAAA,SAAAC,IAEJ,QAAAA,EAAAC,OAAAC,SAAOX,EAAAY,aAAA,MAAAH,EAAAC,OAAAG,eApCeC,CAA4B3B,EAAAW,cACnDiB,EAAA5C,SAAAoC,cAAA,oBAENQ,EAAAP,iBAAA,SAAAC,IAEDA,EAASO,eACLzC,EAA2B0C,KAAA9B,GAE3BQ,EAAMuB,iBAAmB3C,GACjBD,GAA+B6C,EAAAC,mBAAApD,EAAAqD,GAAA/C,EAAAgD,IAAA/C,GAGnCwC,EAAsBQ,UAAA,oBAjD1BC,CALgB,UDtBpBhD,eAA4Be,GACxB,MAAMkC,EAASC,EAAAC,IAAI3D,EAAAqD,GAAI,WAAY9B,GACnC,IAII,aAHsBmC,EAAAE,OAAOH,IACRI,OAGvB,MAAMpB,GACJqB,QAAQC,IAAItB,ICYGuB,CAAatD,GAI5Ba,GAAIb","sources":["src/scripts/functions/getProduct.js","src/scripts/productPage.js"],"sourcesContent":["import { db } from \"../app\";\r\nimport { doc, getDoc } from \"firebase/firestore\";\r\n\r\n\r\nasync function referProduct(id){\r\n    const docRef = doc(db, \"products\", id);\r\n    try{\r\n        const docSnap = await getDoc(docRef);\r\n        const data = docSnap.data();\r\n    \r\n        return data;\r\n    } catch(e){\r\n        console.log(e);\r\n    }\r\n\r\n}\r\n\r\nexport {\r\n    referProduct,\r\n}","import { referProduct } from \"./functions/getProduct\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { addProductToCart, getMycart, currencyFormat } from \"../utils/indexUtils\";\r\nimport { db, auth } from \"../scripts/app\"\r\nimport { getFirebaseCart, createFirebaseCart } from \"./functions/cart\";\r\n\r\nconst productInfoSection = document.getElementById(\"productInfo\");\r\nconst productAssetsSection = document.getElementById(\"productAssets\");\r\n\r\n\r\nlet userLogged = undefined;\r\nlet cart = [];\r\n\r\nfunction getParam(param){\r\n    const url = window.location.search;\r\n    const searchParams = new URLSearchParams(url);\r\n    const productId = searchParams.get(param);\r\n\r\n    return productId;\r\n}\r\n\r\nasync function loadProduct(){\r\n    const productId = getParam(\"id\");\r\n\r\n    const data = await referProduct(productId);\r\n\r\n    const product = {\r\n        ...data,\r\n        id: productId, // docSnap.id,\r\n    }\r\n\r\n    renderProduct(product);\r\n\r\n}\r\n\r\nfunction renderProduct(product){\r\n\r\n    const validateProduct = cart.some((productCart) => productCart.id === product.id);\r\n    const newProductButtonCart = validateProduct ? '<button class=\"product__button\" disabled>Added to cart</button>' : '<button class=\"product__button\">Add to Cart</button>'\r\n\r\n    productInfoSection.innerHTML = ` \r\n\r\n    <h1 class=\"product__name\">${product.name}</h1>\r\n    <p class=\"product__description\">${product.description}</p>\r\n    <h3 class=\"product__price\">${currencyFormat(product.price)}</h3>\r\n    ${newProductButtonCart}\r\n    `;\r\n\r\n    productAssetsSection.innerHTML = `\r\n    <img src=\"${product.images[0]}\" alt=\"\" class=\"product__img\" id=\"main__img\">\r\n    `;\r\n\r\n    if (product.images.lenght > 1){\r\n        createGallery(product.images);\r\n    }\r\n\r\n    const productPageCartButton = document.querySelector(\".product__button\");\r\n    productPageCartButton.addEventListener(\"click\", e =>{\r\n        e.preventDefault;\r\n        cart.push(product);\r\n\r\n        addProductToCart(cart);\r\n\r\n        if (userLogged) {\r\n            createFirebaseCart(db, userLogged.uid, cart);\r\n        }\r\n\r\n        //productPageCartButton.setAttribute(\"disable\", true); //this breaks my code for some reason\r\n        productPageCartButton.innerText = \"Product added!\"\r\n    });\r\n\r\n}\r\n\r\nfunction createGallery(images){\r\n    const mainImage = document.getElementById(\"main__img\");\r\n\r\n    const gallery = document.createElement(\"div\");\r\n    gallery.className = \"product__gallery\";\r\n\r\n    images.forEach(image => {\r\n        gallery.innerHTML += `\r\n        <img sre=\"${image}\">\r\n        `\r\n    });\r\n\r\n    productAssetsSection.appendChild(gallery);\r\n\r\n    const galleryImages = document.querySelector(\".product__gallery\");\r\n\r\n    galleryImages.addEventListener(\"click\", e => {\r\n        if (e.target.tagName === \"IMG\") {\r\n            mainImage.setAttribute(\"src\", e.target.currentSrc);\r\n        }\r\n    });\r\n}\r\n\r\nonAuthStateChanged(auth, async(user) => {\r\n    if (user) {\r\n      // User is signed in, see docs for a list of available properties\r\n      // https://firebase.google.com/docs/reference/js/firebase.User\r\n        userLogged = user;\r\n        cart = await getFirebaseCart(db, userLogged.uid);\r\n      // ...\r\n    } else {\r\n        cart = getMycart();\r\n      // User is signed out\r\n      // ...\r\n    }\r\n\r\n    loadProduct();\r\n\r\n    });\r\n"],"names":["$li1Mx","parcelRequire","$4e9a9ad89da8ea84$var$productInfoSection","document","getElementById","$4e9a9ad89da8ea84$var$productAssetsSection","$4e9a9ad89da8ea84$var$userLogged","$4e9a9ad89da8ea84$var$cart","async","$4e9a9ad89da8ea84$var$loadProduct","productId","param","url","window","location","search","URLSearchParams","get","$4e9a9ad89da8ea84$var$getParam","product","newProductButtonCart","some","productCart","id","innerHTML","name","description","$jKvpL","currencyFormat","price","images","lenght","mainImage","gallery","createElement","className","forEach","image","appendChild","querySelector","addEventListener","e","target","tagName","setAttribute","currentSrc","$4e9a9ad89da8ea84$var$createGallery","productPageCartButton","preventDefault","push","addProductToCart","$hMt9z","createFirebaseCart","db","uid","innerText","$4e9a9ad89da8ea84$var$renderProduct","docRef","$etBjH","doc","getDoc","data","console","log","$96d763eed7c24a29$export$1e58c1a5adc6326e"],"version":3,"file":"productPage.fc8cac6e.js.map"}