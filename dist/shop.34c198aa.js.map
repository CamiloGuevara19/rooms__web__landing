{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,SCAAC,EAAAD,EAAA,oDDMA,MAAME,EAAiBC,SAASC,eAAe,YACzCC,EAAiBF,SAASC,eAAe,YACzCE,EAAcH,SAASC,eAAe,SAE5C,IAAIG,EACAC,EAAW,GACXC,EAAO,GAGXC,eAAeC,IAEX,MAAMC,QCfVF,eAA2BG,GACvB,MAAMC,EAAgBb,EAAAc,WAAWF,EAAI,YAErC,IACI,MANRG,KAMgBA,SAAef,EAAAgB,QAAQH,GAU/B,OARiBE,EAAKE,KAAKC,IAEhB,IACAA,EAAIC,OACPC,GAAIF,EAAIE,OAMlB,MAAMC,GACJC,QAAQC,IAAIF,IDFeG,CAAY1B,EAAAc,IAC3CD,EAAiBc,SAASC,IACtBC,EAAcD,MAKlBnB,EAAWI,EAGf,SAASgB,EAAcC,GACnB,MAAMF,EAAUxB,SAAS2B,cAAc,KACvCH,EAAQI,UAAY,WACpBJ,EAAQI,UAAY,gBACpBJ,EAAQI,UAAY,gBACpBJ,EAAQI,UAAY,mBACpBJ,EAAQI,UAAY,kBACpBJ,EAAQI,UAAY,kBACpBJ,EAAQI,UAAY,iBAEpBJ,EAAQK,aAAa,OAAQ,yBAAyBH,EAAKR,MAE3D,MAAMY,EAAaJ,EAAKK,OAASL,EAAKK,OAAO,GAAK,oFAI5CC,EAFkB1B,EAAK2B,MAAMC,GAAgBA,EAAYhB,KAAOQ,EAAKR,KAE/B,gEAAkE,qDAE9GM,EAAQW,UAAY,wDAedL,sHAMFJ,EAAAU,kDAEGC,EAAUC,eACHZ,EAAAa,wBAIVP,sCAKRjC,EAAiByC,YAAGhB,GAChB,MAAMiB,EAAcjB,EAAAkB,cAAA,kBACpBD,EAAiBE,iBAAA,SAAApC,MAAWY,IAExBA,EAAAyB,iBAEAtC,EAEAuC,KAAAnB,GAAiFW,EAAAS,iBAAAxC,GAIjFF,SAAkB2C,EAASC,mBAAApD,EAAAc,GAAAN,EAAA6C,IAAA3C,GAIyCmC,EAAAS,UAAA,6BAQxEC,IACA,MAAAC,EAAgBlD,EAAoBmD,MAChCC,EAAAnD,EAAuBkD,UACxBE,EAAA,GAENA,EAAA,KAAAH,EAAA/C,EAAAmD,QAAAhC,GAAAA,EAAAiC,WAAAL,IAGG/C,EACD,WAAAiD,IAAAC,EAAAA,EAAAG,MAAA,CAAAC,EAAAC,IAAAD,EAAApB,MAAAqB,EAAArB,SAGC,aAAAe,IAAAC,EAAWA,EAAAG,MAAA,CAAAC,EAAAC,IAAAA,EAAArB,MAAAoB,EAAApB,SAGfxC,EAAAoC,UAAA,GACIoB,EAAUhC,SAAAC,IACRC,EAAAD,QAGSmB,iBAAM,UAAAxB,IACfgC,SAOFR,iBAAe,UAAAxB,IAEZgC","sources":["src/scripts/shop.js","src/scripts/functions/porducts.js"],"sourcesContent":["import { db, auth } from \"../scripts/app\"\r\nimport { getProducts } from \"./functions/porducts\";\r\nimport { createFirebaseCart, getFirebaseCart } from \"./functions/cart\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { addProductToCart, getMycart, currencyFormat } from \"../utils/indexUtils\";\r\n\r\nconst productSection = document.getElementById(\"products\");\r\nconst categoryFilter = document.getElementById(\"category\");\r\nconst priceFilter = document.getElementById(\"order\");\r\n\r\nlet userLogged = undefined;\r\nlet products = [];\r\nlet cart = [];\r\n//console.log(cart);\r\n\r\nasync function loadProducts() {\r\n\r\n    const firebaseProducts = await getProducts(db);\r\n    firebaseProducts.forEach( product => {\r\n        renderProduct(product);\r\n    });\r\n\r\n    //console.log(firebaseProducts);\r\n\r\n    products = firebaseProducts;\r\n}\r\n\r\nfunction renderProduct(item) {\r\n    const product = document.createElement(\"a\")\r\n    product.className = \"products\";\r\n    product.className = \"products__box\";\r\n    product.className = \"products__img\";\r\n    product.className = \"products__detail\";\r\n    product.className = \"products__title\";\r\n    product.className = \"products__price\";\r\n    product.className = \"products__more\";\r\n\r\n    product.setAttribute(\"href\", `./productPage.html?id=${item.id}`);\r\n\r\n    const coverImage = item.images ? item.images[0] : \"https://latarta.com.co/wp-content/uploads/2018/06/default-placeholder-300x300.png\"; \r\n\r\n    const validateProduct = cart.some((productCart) => productCart.id === item.id);\r\n\r\n    const productButtonCart = validateProduct ? '<button class=\"products__btn\" disabled>Added to cart</button>' : '<button class=\"products__btn\">Add to Cart</button>'\r\n\r\n    product.innerHTML = `\r\n    <article class=\"products__box\">\r\n    <img src=\"${coverImage}\" alt=\"\" class=\"products__img\">\r\n    \r\n    <div class=\"products__details\">\r\n\r\n        <h4 class=\"products__title\">${item.name}</h4>\r\n        <h3 class=\"products__price\">${currencyFormat(item.price)}</h3>\r\n        ${productButtonCart}\r\n    </div>\r\n    </article>\r\n    `;\r\n\r\n    productSection.appendChild(product);\r\n\r\n    const addProductButton  = product.querySelector(\".products__btn\");\r\n\r\n    addProductButton.addEventListener(\"click\", async (e) => {\r\n        e.preventDefault();\r\n\r\n        cart.push(item);\r\n        addProductToCart(cart);\r\n\r\n        if(userLogged){\r\n            await createFirebaseCart(db, userLogged.uid, cart);\r\n\r\n        }\r\n\r\n        //addProductButton.setAttribute(\"disabled\", true); //this breaks my code for some reason\r\n        addProductButton.innerText = \"Product added!\"\r\n    });\r\n}\r\n\r\nfunction filterBy() {\r\n    const newCategory = categoryFilter.value;\r\n    const newOrder = priceFilter.value;\r\n\r\n    let filteredProduct = [];\r\n\r\n    if (newCategory !== \"\"){\r\n\r\n        filteredProduct = products.filter((product) => product.category === newCategory);\r\n        //console.log(filteredProduct);\r\n\r\n    }else {\r\n        filteredProduct = products;\r\n    }\r\n\r\n    if (newOrder === \"upward\") {\r\n        filteredProduct = filteredProduct.sort((a, b) => a.price - b.price);\r\n    }\r\n\r\n    if (newOrder === \"downward\") {\r\n        filteredProduct = filteredProduct.sort((a ,b) => b.price - a.price);\r\n    }\r\n\r\n\r\n    productSection.innerHTML=\"\";\r\n    filteredProduct.forEach( product => {\r\n        renderProduct(product);\r\n    });\r\n\r\n}\r\n\r\ncategoryFilter.addEventListener(\"change\", e => {\r\n    filterBy();\r\n});\r\n\r\npriceFilter.addEventListener(\"change\", e => {\r\n    filterBy();\r\n});\r\n\r\nonAuthStateChanged(auth, async(user) => {\r\n    if (user) {\r\n      // User is signed in, see docs for a list of available properties\r\n      // https://firebase.google.com/docs/reference/js/firebase.User\r\n        userLogged = user;\r\n        cart = await getFirebaseCart(db, userLogged.uid);\r\n      // ...\r\n    } else {\r\n        cart = getMycart();\r\n      // User is signed out\r\n      // ...\r\n    }\r\n\r\n    loadProducts();\r\n\r\n    });\r\n\r\n","import { collection, getDocs } from \"firebase/firestore\";\r\n\r\nasync function getProducts(db){\r\n    const collectionRef = collection(db, \"products\");\r\n\r\n    try {\r\n        const { docs } = await getDocs(collectionRef);\r\n\r\n        const products = docs.map((doc) =>{\r\n            //console.log(doc)\r\n            return {\r\n                ...doc.data(),\r\n                id: doc.id,\r\n            };\r\n        });\r\n\r\n        return products;\r\n        \r\n    } catch(e){\r\n        console.log(e);\r\n\r\n    }\r\n\r\n    //console.log(products);\r\n}\r\n\r\nexport{\r\n    getProducts,\r\n}"],"names":["$li1Mx","parcelRequire","$etBjH","$a9cddcee321f50ec$var$productSection","document","getElementById","$a9cddcee321f50ec$var$categoryFilter","$a9cddcee321f50ec$var$priceFilter","$a9cddcee321f50ec$var$userLogged","$a9cddcee321f50ec$var$products","$a9cddcee321f50ec$var$cart","async","$a9cddcee321f50ec$var$loadProducts","firebaseProducts","db","collectionRef","collection","docs","getDocs","map","doc","data","id","e","console","log","$971d967594fbb5eb$export$68a801b7b3c0bfaa","forEach","product","$a9cddcee321f50ec$var$renderProduct","item","createElement","className","setAttribute","coverImage","images","productButtonCart","some","productCart","innerHTML","name","$jKvpL","currencyFormat","price","appendChild","addProductButton","querySelector","addEventListener","preventDefault","push","addProductToCart","$hMt9z","createFirebaseCart","uid","innerText","$a9cddcee321f50ec$var$filterBy","newCategory","value","newOrder","filteredProduct","filter","category","sort","a","b"],"version":3,"file":"shop.34c198aa.js.map"}