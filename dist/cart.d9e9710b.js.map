{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,gDAKA,MAAMC,EAAcC,SAASC,eAAe,QACtCC,EAAeF,SAASC,eAAe,SAC7C,IAAIE,EAAO,GAEX,SAASC,IACL,IAAIC,EAAQ,EACZF,EAAKG,SAAQC,KAyBjB,SAAuBA,GACnB,MAAMC,EAAcR,SAASS,cAAc,MAC3CD,EAAYE,UAAY,gBAExBF,EAAYG,UAAY,qCAOxBJ,EAAYK,OAAW,2CAEXL,EAAiBM,0CACLC,EAAKC,eAAUR,EAAAS,gFAGlCC,YAAAT,KACHU,iBAAA,SAAAC,IACL,WAAAA,EAAAC,OAAAC,UAEDC,QAAAC,IAAA,cAtCAC,eAA6BC,GACzB,MAAMC,EAAUvB,EAAKwB,QAAOpB,GAAWA,EAAQqB,KAAOH,IAEtDtB,EAAOuB,EAEHG,kBACMC,EAAAC,mBAAmBlC,EAAAmC,GAAIH,WAAWI,IAAKP,GAGjDZ,EAAAoB,iBAAiBR,GAEjB3B,EAAYY,UAAY,GAExBP,IA0BQ+B,CAAE5B,EAAAqB,QA9CNQ,CAAc7B,GACdF,GAASgC,SAAS9B,EAAQS,UAG9Bd,EAAaoC,UAAYxB,EAAAC,eAAeV,wBA8CpCR,EAAA0C,MAAAf,MAAAgB,IACFA,GASCX,WAAAW","sources":["src/scripts/cart.js"],"sourcesContent":["import { auth, db } from \"./app\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { getFirebaseCart, createFirebaseCart } from \"./functions/cart\";\r\nimport { addProductToCart, getMycart, currencyFormat } from \"../utils/indexUtils\";\r\n\r\nconst cartSection = document.getElementById(\"cart\");\r\nconst totalSection = document.getElementById(\"total\");\r\nlet cart = [];\r\n\r\nfunction loadCart(){\r\n    let total = 0;\r\n    cart.forEach(product => {\r\n        renderProduct(product);\r\n        total += parseInt(product.price);\r\n    });\r\n\r\n    totalSection.innerText = currencyFormat(total);\r\n}\r\n\r\nasync function removeProduct(productId) {\r\n    const newCart = cart.filter(product => product.id !== productId);\r\n    \r\n    cart = newCart;\r\n\r\n    if (userLogged) {\r\n        await createFirebaseCart(db, userLogged.uid, newCart);\r\n    }\r\n\r\n    addProductToCart(newCart);\r\n\r\n    cartSection.innerHTML = \"\";\r\n\r\n    loadCart(newCart);\r\n\r\n}\r\n\r\nfunction renderProduct(product){\r\n    const productCart = document.createElement(\"li\");\r\n    productCart.className = \"cart__product\";\r\n\r\n    productCart.innerHTML = `\r\n    <img class=\"cart__img\" src=\"${product.images[0]}\" alt=\"\">\r\n    <h2 class=\"cart__name\">${product.name}</h2>\r\n    <h3 class=\"cart__price\">${currencyFormat(product.price)}</h3>\r\n    <button class=\"cart__button\">Delete product</button>\r\n    `;\r\n    \r\n    cartSection.appendChild(productCart);\r\n\r\n    productCart.addEventListener(\"click\", e => {\r\n        if (e.target.tagName === \"BUTTON\") {\r\n            console.log(\"remove it!\");\r\n            removeProduct(product.id);\r\n        }\r\n    })\r\n};\r\n\r\nonAuthStateChanged(auth, async(user) => {\r\n    if (user) {\r\n      // User is signed in, see docs for a list of available properties\r\n      // https://firebase.google.com/docs/reference/js/firebase.User\r\n        userLogged = user;\r\n        cart = await getFirebaseCart(db, userLogged.uid);\r\n      // ...\r\n    } else {\r\n        cart = getMycart();\r\n      // User is signed out\r\n      // ...\r\n    }\r\n\r\n    loadCart();\r\n\r\n    });"],"names":["$li1Mx","parcelRequire","$ff14a25859eedfe9$var$cartSection","document","getElementById","$ff14a25859eedfe9$var$totalSection","$ff14a25859eedfe9$var$cart","$ff14a25859eedfe9$var$loadCart","total","forEach","product","productCart","createElement","className","innerHTML","images","name","$jKvpL","currencyFormat","price","appendChild","addEventListener","e","target","tagName","console","log","async","productId","newCart","filter","id","userLogged","$hMt9z","createFirebaseCart","db","uid","addProductToCart","$ff14a25859eedfe9$var$removeProduct","$ff14a25859eedfe9$var$renderProduct","parseInt","innerText","auth","user"],"version":3,"file":"cart.d9e9710b.js.map"}